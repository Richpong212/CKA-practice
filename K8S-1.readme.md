# Kubernetes CKA Practice Tasks & Solutions

This document contains structured solutions to common Certified Kubernetes Administrator (CKA) practice tasks, formatted for easy note-taking and review.

---

## ‚úÖ Q. 4 ‚Äî Resize PVC

**SECTION:** Storage
**CLUSTER:** `cluster1-controlplane`

### üìù Task

A PersistentVolume `papaya-pv-cka09-str` (150Mi, using `papaya-stc-cka09-str` with path `/opt/papaya-stc-cka09-str`) and a PersistentVolumeClaim `papaya-pvc-cka09-str` (50Mi) are already created.
Resize the PVC to `80Mi` and ensure it's in `Bound` state.

### üõ†Ô∏è Solution

```bash
ssh cluster1-controlplane
```

#### Option 1: YAML-Based Method

```bash
kubectl get pv papaya-pv-cka09-str -o yaml > /tmp/papaya-pv.yaml
vi /tmp/papaya-pv.yaml
# Remove: uid, annotations, status, claimRef

kubectl get pvc papaya-pvc-cka09-str -o yaml > /tmp/papaya-pvc.yaml
vi /tmp/papaya-pvc.yaml
# Update storage to 80Mi

kubectl delete pvc papaya-pvc-cka09-str
kubectl delete pv papaya-pv-cka09-str
kubectl apply -f /tmp/papaya-pv.yaml
kubectl apply -f /tmp/papaya-pvc.yaml
```

#### Option 2: Patch-Based Method

```bash
kubectl patch pv papaya-pv-cka09-str --type=json -p='[
  {"op": "remove", "path": "/metadata/uid"},
  {"op": "remove", "path": "/metadata/annotations"},
  {"op": "remove", "path": "/status"},
  {"op": "remove", "path": "/spec/claimRef"}
]'

kubectl patch pvc papaya-pvc-cka09-str --type=json -p='[
  {"op": "replace", "path": "/spec/resources/requests/storage", "value": "80Mi"}
]'
```

---

## ‚úÖ Q. 5 ‚Äî Helm Chart Fix & Deploy

**SECTION:** Cluster Architecture, Installation & Configuration
**CLUSTER:** `cluster2-controlplane`

### üìù Task

Fix and deploy a Helm chart from `/opt/webapp-color-apd` with:

- Release: `webapp-color-apd`
- Namespace: `frontend-apd`
- Service: `NodePort`
- Replicas: `3`
- App version: `1.20.0`

### üõ†Ô∏è Solution

```bash
ssh cluster2-controlplane
kubectl get ns
kubectl create ns frontend-apd
cd /opt/webapp-color-apd

# Update:
# - Chart.yaml -> appVersion: 1.20.0
# - values.yaml -> replicaCount: 3, service.type: NodePort

helm lint /opt/webapp-color-apd/
# Fix apiVersion in deployment to apps/v1
# Fix template variables (e.g. .Values.service.name)

helm install webapp-color-apd -n frontend-apd /opt/webapp-color-apd
helm ls -n frontend-apd
```

---

## ‚úÖ Q. 6 ‚Äî HTTPRoute

**SECTION:** Services and Networking
**CLUSTER:** `cluster2-controlplane`

### üìù Task

Create `HTTPRoute` named `web-route` in namespace `nginx-gateway` for service `web-service` with hostname `cluster2-controlplane`.

### üõ†Ô∏è Solution

```yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: web-route
  namespace: nginx-gateway
spec:
  hostnames:
    - cluster2-controlplane
  parentRefs:
    - name: web-gateway
  rules:
    - backendRefs:
        - name: web-service
          port: 80
```

```bash
kubectl apply -f <http-route-file>.yaml
curl http://cluster2-controlplane:30080
```

---

## ‚úÖ Q. 7 ‚Äî Service Account + Role + Binding

**SECTION:** Cluster Architecture, Installation & Configuration
**CLUSTER:** `cluster1-controlplane`

### üõ†Ô∏è Solution

```bash
ssh cluster1-controlplane

kubectl create serviceaccount deploy-cka20-arch
kubectl create clusterrole deploy-role-cka20-arch --resource=deployments --verb=get
kubectl create clusterrolebinding deploy-role-binding-cka20-arch \
  --clusterrole=deploy-role-cka20-arch \
  --serviceaccount=default:deploy-cka20-arch

kubectl auth can-i get deployments --as=system:serviceaccount:default:deploy-cka20-arch
# Expected: yes
```

---

## ‚úÖ Q. 8 ‚Äî DNS Resolution

**SECTION:** Services and Networking
**CLUSTER:** `cluster1-controlplane`

### üõ†Ô∏è Solution

```bash
ssh cluster1-controlplane
kubectl run nginx-resolver-cka06-svcn --image=nginx
kubectl expose pod nginx-resolver-cka06-svcn --name=nginx-resolver-service-cka06-svcn --port=80 --target-port=80 --type=ClusterIP

kubectl run test-nslookup --image=busybox:1.28 --rm -it --restart=Never -- nslookup nginx-resolver-service-cka06-svcn > /root/CKA/nginx.svc.cka06.svcn

IP=$(kubectl get pod nginx-resolver-cka06-svcn -o wide --no-headers | awk '{print $6}' | tr '.' '-')
kubectl run test-nslookup --image=busybox:1.28 --rm -it --restart=Never -- nslookup $IP.default.pod > /root/CKA/nginx.pod.cka06.svcn
```

---

## ‚úÖ Q. 9 ‚Äî Pod Pending

**SECTION:** Troubleshooting
**CLUSTER:** `cluster4-controlplane`

### üìù Task

Investigate and fix `grey-cka21-trb` pod stuck in `Pending` state.

(Instructions pending formatting. To be added in next update.)

---

## ‚úÖ Q. 10 ‚Äî Rollback & Scale

**SECTION:** Workloads & Scheduling
**CLUSTER:** `cluster1-controlplane`

### üõ†Ô∏è Solution

```bash
ssh cluster1-controlplane
kubectl get pods -n dev-wl07
kubectl rollout undo -n dev-wl07 deploy webapp-wl07
kubectl describe deploy -n dev-wl07 webapp-wl07 | grep -i image

echo "kodekloud/webapp-color" > /root/rolling-back-record.txt
kubectl scale deploy -n dev-wl07 webapp-wl07 --replicas=5
kubectl get deploy -n dev-wl07
```

---

(Additional Q11‚ÄìQ16 formatting will continue in the next update. Let me know if you'd like to complete the rest immediately or review first.)
